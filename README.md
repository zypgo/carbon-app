# ç¢³ä¿¡ç”¨äº¤æ˜“DApp / Carbon Credit Trading DApp

[English](#english) | [ä¸­æ–‡](#chinese)

è¯·è®¿é—®ä»¥ä¸‹åœ°å€ä½“éªŒé¡¹ç›®å§ï¼ https://zypgo.github.io/carbon-app/
---

## <a id="chinese"></a>ä¸­æ–‡ç‰ˆ

### ğŸŒ± é¡¹ç›®ç®€ä»‹

ç¢³ä¿¡ç”¨äº¤æ˜“DAppæ˜¯ä¸€ä¸ªåŸºäºåŒºå—é“¾æŠ€æœ¯çš„å»ä¸­å¿ƒåŒ–ç¢³ä¿¡ç”¨äº¤æ˜“å¹³å°ï¼Œæ—¨åœ¨é€šè¿‡æ™ºèƒ½åˆçº¦å’ŒWeb3æŠ€æœ¯æé«˜ç¢³äº¤æ˜“çš„é€æ˜åº¦ã€å¯ä¿¡åº¦å’Œæ•ˆç‡ã€‚æœ¬é¡¹ç›®å®ç°äº†å®Œæ•´çš„ç¢³æ’æ”¾è®°å½•ã€ç¢³ä¿¡ç”¨é¡¹ç›®ç®¡ç†ã€ç¢³ä¿¡ç”¨äº¤æ˜“å’ŒéªŒè¯ç­‰åŠŸèƒ½ï¼Œä¸ºç¢³ä¸­å’Œç›®æ ‡æä¾›æŠ€æœ¯æ”¯æŒã€‚

### âœ¨ æ ¸å¿ƒåŠŸèƒ½

#### ğŸ”— é’±åŒ…è¿æ¥ä¸èº«ä»½ç®¡ç†
- **MetaMaské›†æˆ**ï¼šæ”¯æŒMetaMaské’±åŒ…è¿æ¥
- **å¤šç½‘ç»œæ”¯æŒ**ï¼šæ”¯æŒä»¥å¤ªåŠä¸»ç½‘ã€æµ‹è¯•ç½‘ç»œ
- **èº«ä»½éªŒè¯**ï¼šåŸºäºåŒºå—é“¾åœ°å€çš„èº«ä»½éªŒè¯
- **æƒé™ç®¡ç†**ï¼šæ”¯æŒéªŒè¯è€…ã€æä¾›å•†ç­‰å¤šç§è§’è‰²

#### ğŸ“Š ç¢³æ’æ”¾è®°å½•ç³»ç»Ÿ
- **æ’æ”¾æ•°æ®è®°å½•**ï¼šæ”¯æŒå¤šç§æ´»åŠ¨ç±»å‹çš„ç¢³æ’æ”¾è®°å½•
- **æ•°æ®éªŒè¯**ï¼šéªŒè¯è€…å¯ä»¥å®¡æ ¸å’Œç¡®è®¤æ’æ”¾è®°å½•
- **ç»Ÿè®¡åˆ†æ**ï¼šæä¾›æ’æ”¾é‡ç»Ÿè®¡å’Œè¶‹åŠ¿åˆ†æ
- **å†å²æŸ¥è¯¢**ï¼šå®Œæ•´çš„æ’æ”¾è®°å½•å†å²æŸ¥è¯¢

#### ğŸ­ ç¢³ä¿¡ç”¨é¡¹ç›®ç®¡ç†
- **é¡¹ç›®æäº¤**ï¼šå‡æ’é¡¹ç›®æä¾›å•†å¯ä»¥æäº¤é¡¹ç›®ç”³è¯·
- **é¡¹ç›®å®¡æ ¸**ï¼šéªŒè¯è€…å¯¹é¡¹ç›®è¿›è¡Œå®¡æ ¸å’ŒéªŒè¯
- **ä¿¡ç”¨ç”Ÿæˆ**ï¼šå®¡æ ¸é€šè¿‡çš„é¡¹ç›®è‡ªåŠ¨ç”Ÿæˆç¢³ä¿¡ç”¨
- **é¡¹ç›®è·Ÿè¸ª**ï¼šå®æ—¶è·Ÿè¸ªé¡¹ç›®çŠ¶æ€å’Œè¿›åº¦

#### ğŸ’° ç¢³ä¿¡ç”¨äº¤æ˜“å¸‚åœº
- **ä¿¡ç”¨ä¸Šæ¶**ï¼šç”¨æˆ·å¯ä»¥å°†ç¢³ä¿¡ç”¨ä¸Šæ¶é”€å”®
- **å¸‚åœºæµè§ˆ**ï¼šæµè§ˆæ‰€æœ‰å¯è´­ä¹°çš„ç¢³ä¿¡ç”¨
- **å³æ—¶äº¤æ˜“**ï¼šæ”¯æŒå³æ—¶è´­ä¹°å’Œäº¤æ˜“
- **ä»·æ ¼å‘ç°**ï¼šå¸‚åœºåŒ–çš„ä»·æ ¼å‘ç°æœºåˆ¶

#### ğŸ‘¤ ä¸ªäººä¸­å¿ƒ
- **èµ„äº§ç®¡ç†**ï¼šæŸ¥çœ‹ä¸ªäººç¢³ä¿¡ç”¨ä½™é¢
- **äº¤æ˜“å†å²**ï¼šå®Œæ•´çš„äº¤æ˜“è®°å½•æŸ¥è¯¢
- **æ’æ”¾ç»Ÿè®¡**ï¼šä¸ªäººç¢³æ’æ”¾æ•°æ®ç»Ÿè®¡
- **é¡¹ç›®å‚ä¸**ï¼šå‚ä¸çš„é¡¹ç›®çŠ¶æ€æŸ¥çœ‹

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

#### å‰ç«¯æŠ€æœ¯æ ˆ
- **React 18**ï¼šç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢æ¡†æ¶ï¼Œæ”¯æŒå¹¶å‘ç‰¹æ€§å’Œè‡ªåŠ¨æ‰¹å¤„ç†
- **TypeScript**ï¼šç±»å‹å®‰å…¨çš„JavaScriptè¶…é›†ï¼Œæä¾›å®Œæ•´çš„ç±»å‹æ£€æŸ¥
- **Vite**ï¼šå¿«é€Ÿçš„æ„å»ºå·¥å…·å’Œå¼€å‘æœåŠ¡å™¨ï¼Œæ”¯æŒçƒ­æ¨¡å—æ›¿æ¢(HMR)
- **Tailwind CSS**ï¼šåŸå­åŒ–CSSæ¡†æ¶ï¼Œæä¾›é«˜åº¦å¯å®šåˆ¶çš„æ ·å¼ç³»ç»Ÿ
- **React Router v6**ï¼šç°ä»£åŒ–çš„å®¢æˆ·ç«¯è·¯ç”±ç®¡ç†
- **Zustand**ï¼šè½»é‡çº§çŠ¶æ€ç®¡ç†ï¼Œç®€å•æ˜“ç”¨çš„çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆ
- **ethers.js v6**ï¼šä»¥å¤ªåŠJavaScriptåº“ï¼Œç”¨äºä¸åŒºå—é“¾äº¤äº’
- **React i18next**ï¼šå›½é™…åŒ–æ”¯æŒï¼Œæä¾›å¤šè¯­è¨€åˆ‡æ¢åŠŸèƒ½
- **Lucide React**ï¼šç°ä»£åŒ–çš„å›¾æ ‡åº“
- **Sonner**ï¼šä¼˜é›…çš„é€šçŸ¥ç»„ä»¶

#### åŒºå—é“¾æŠ€æœ¯æ ˆ
- **Solidity 0.8.19+**ï¼šæ™ºèƒ½åˆçº¦å¼€å‘è¯­è¨€ï¼Œæ”¯æŒæœ€æ–°è¯­è¨€ç‰¹æ€§
- **Hardhat**ï¼šä»¥å¤ªåŠå¼€å‘ç¯å¢ƒï¼Œæä¾›ç¼–è¯‘ã€æµ‹è¯•ã€éƒ¨ç½²åŠŸèƒ½
- **OpenZeppelin Contracts**ï¼šç»è¿‡å®¡è®¡çš„å®‰å…¨æ™ºèƒ½åˆçº¦åº“
- **ERC-721**ï¼šNFTæ ‡å‡†å®ç°ï¼Œç”¨äºç¢³ä¿¡ç”¨ä»£å¸åŒ–
- **AccessControl**ï¼šåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ç³»ç»Ÿ
- **ReentrancyGuard**ï¼šé‡å…¥æ”»å‡»é˜²æŠ¤æœºåˆ¶

#### æ™ºèƒ½åˆçº¦æ¶æ„è¯¦è§£

##### åŒåˆçº¦æ¶æ„è®¾è®¡
æœ¬é¡¹ç›®é‡‡ç”¨åŒåˆçº¦æ¶æ„ï¼Œå°†ä¸šåŠ¡é€»è¾‘å’Œä»£å¸ç®¡ç†åˆ†ç¦»ï¼š

**CarbonCreditSystem.sol - æ ¸å¿ƒä¸šåŠ¡åˆçº¦**
- æ’æ”¾è®°å½•ç®¡ç†ï¼šè®°å½•å’ŒéªŒè¯ç¢³æ’æ”¾æ•°æ®
- é¡¹ç›®ç®¡ç†ï¼šç¢³ä¿¡ç”¨é¡¹ç›®çš„åˆ›å»ºã€å®¡æ ¸å’Œç®¡ç†
- äº¤æ˜“å¸‚åœºï¼šç¢³ä¿¡ç”¨çš„ä¸Šæ¶ã€è´­ä¹°å’Œäº¤æ˜“
- æƒé™ç®¡ç†ï¼šåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆéªŒè¯è€…ã€æä¾›å•†ç­‰ï¼‰
- æ•°æ®ç»Ÿè®¡ï¼šå¹³å°æ•´ä½“æ•°æ®ç»Ÿè®¡å’Œåˆ†æ

**CarbonCreditNFT.sol - NFTä»£å¸åˆçº¦**
- ERC-721æ ‡å‡†å®ç°ï¼šç¢³ä¿¡ç”¨çš„ä»£å¸åŒ–è¡¨ç¤º
- å…ƒæ•°æ®ç®¡ç†ï¼šç¢³ä¿¡ç”¨çš„è¯¦ç»†ä¿¡æ¯å­˜å‚¨
- é“¸é€ æƒé™ï¼šåªæœ‰æˆæƒåˆçº¦å¯ä»¥é“¸é€ æ–°çš„ç¢³ä¿¡ç”¨
- è½¬è´¦æ§åˆ¶ï¼šæ”¯æŒæ ‡å‡†çš„NFTè½¬è´¦åŠŸèƒ½

##### æ ¸å¿ƒæ•°æ®ç»“æ„
```solidity
// æ’æ”¾è®°å½•ç»“æ„
struct EmissionRecord {
    uint256 amount;          // æ’æ”¾é‡ï¼ˆä»¥weiä¸ºå•ä½ï¼‰
    string activityType;     // æ´»åŠ¨ç±»å‹
    uint256 timestamp;       // è®°å½•æ—¶é—´æˆ³
    bool verified;           // æ˜¯å¦å·²éªŒè¯
    address verifier;        // éªŒè¯è€…åœ°å€
}

// ç¢³ä¿¡ç”¨é¡¹ç›®ç»“æ„
struct Project {
    uint256 id;              // é¡¹ç›®ID
    string name;             // é¡¹ç›®åç§°
    string description;      // é¡¹ç›®æè¿°
    string projectType;      // é¡¹ç›®ç±»å‹
    uint256 totalCredits;    // æ€»ç¢³ä¿¡ç”¨é‡
    uint256 availableCredits; // å¯ç”¨ç¢³ä¿¡ç”¨é‡
    address provider;        // é¡¹ç›®æä¾›å•†
    bool approved;           // æ˜¯å¦å·²å®¡æ ¸
    uint256 createdAt;       // åˆ›å»ºæ—¶é—´
}

// äº¤æ˜“æŒ‚å•ç»“æ„
struct CreditListing {
    uint256 id;              // æŒ‚å•ID
    address seller;          // å–å®¶åœ°å€
    uint256 amount;          // ç¢³ä¿¡ç”¨æ•°é‡
    uint256 pricePerCredit;  // å•ä»·ï¼ˆä»¥weiä¸ºå•ä½ï¼‰
    uint256 projectId;       // å…³è”é¡¹ç›®ID
    bool active;             // æ˜¯å¦æ´»è·ƒ
    uint256 listedAt;        // ä¸Šæ¶æ—¶é—´
}
```

##### æƒé™ç®¡ç†ç³»ç»Ÿ
åŸºäºOpenZeppelinçš„AccessControlå®ç°å¤šè§’è‰²æƒé™ç®¡ç†ï¼š

- **DEFAULT_ADMIN_ROLE**ï¼šç³»ç»Ÿç®¡ç†å‘˜ï¼Œå¯ä»¥åˆ†é…å…¶ä»–è§’è‰²
- **VERIFIER_ROLE**ï¼šéªŒè¯è€…è§’è‰²ï¼Œå¯ä»¥éªŒè¯æ’æ”¾è®°å½•å’Œå®¡æ ¸é¡¹ç›®
- **PROVIDER_ROLE**ï¼šé¡¹ç›®æä¾›å•†è§’è‰²ï¼Œå¯ä»¥æäº¤ç¢³ä¿¡ç”¨é¡¹ç›®
- **MINTER_ROLE**ï¼šé“¸é€ è€…è§’è‰²ï¼Œå¯ä»¥é“¸é€ æ–°çš„ç¢³ä¿¡ç”¨NFT

#### Web3é›†æˆæ¶æ„

##### Web3Contextä¸Šä¸‹æ–‡ç®¡ç†
```typescript
interface Web3ContextType {
  // è¿æ¥çŠ¶æ€
  isConnected: boolean;
  isConnecting: boolean;
  
  // è´¦æˆ·ä¿¡æ¯
  account: string | null;
  chainId: number | null;
  balance: string;
  
  // Web3å®ä¾‹
  provider: ethers.BrowserProvider | null;
  signer: ethers.JsonRpcSigner | null;
  contract: ethers.Contract | null;
  
  // ç”¨æˆ·è§’è‰²
  userRole: 'user' | 'verifier' | null;
  
  // æ“ä½œæ–¹æ³•
  connectWallet: () => Promise<void>;
  disconnectWallet: () => void;
  switchNetwork: (chainId: number) => Promise<void>;
  switchRole: () => void;
}
```

##### åˆçº¦æœåŠ¡å±‚è®¾è®¡
```typescript
class ContractService {
  private contract: ethers.Contract;
  private signer: ethers.JsonRpcSigner;
  
  // æ’æ”¾è®°å½•ç›¸å…³æ–¹æ³•
  async recordEmission(amount: number, activityType: string): Promise<Transaction>;
  async getUserEmissions(userAddress: string): Promise<EmissionRecord[]>;
  async verifyEmission(userAddress: string, index: number): Promise<Transaction>;
  
  // é¡¹ç›®ç®¡ç†ç›¸å…³æ–¹æ³•
  async submitProject(name: string, description: string, projectType: string, totalCredits: number): Promise<Transaction>;
  async getAllProjects(): Promise<Project[]>;
  async approveProject(projectId: number): Promise<Transaction>;
  
  // äº¤æ˜“å¸‚åœºç›¸å…³æ–¹æ³•
  async listCredit(amount: number, pricePerCredit: number, projectId: number): Promise<Transaction>;
  async buyCredit(listingId: number): Promise<Transaction>;
  async getAllListings(): Promise<CreditListing[]>;
  
  // ç”¨æˆ·æ•°æ®ç›¸å…³æ–¹æ³•
  async getUserBalance(userAddress: string): Promise<number>;
  async getUserTransactions(userAddress: string): Promise<Transaction[]>;
}
```

### ğŸ“‹ ç³»ç»Ÿè¦æ±‚

#### å¼€å‘ç¯å¢ƒ
- **Node.js**: v16.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **npm**: v7.0.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Git**: ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
- **MetaMask**: æµè§ˆå™¨é’±åŒ…æ’ä»¶

#### æµè§ˆå™¨æ”¯æŒ
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

### ğŸš€ å¿«é€Ÿå¼€å§‹

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-username/carbon-credit-dapp.git
cd carbon-credit-dapp/carbon-app
```

#### 2. å®‰è£…ä¾èµ–
```bash
npm install
```

#### 3. ç¯å¢ƒé…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
# VITE_INFURA_PROJECT_ID=your_infura_project_id
# VITE_CONTRACT_ADDRESS=deployed_contract_address
```

#### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```

#### 5. è®¿é—®åº”ç”¨
æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:5173`

### ğŸ”§ æ™ºèƒ½åˆçº¦éƒ¨ç½²

#### æœ¬åœ°å¼€å‘ç½‘ç»œ
```bash
# å¯åŠ¨æœ¬åœ°Hardhatç½‘ç»œ
npx hardhat node

# éƒ¨ç½²åˆçº¦
npx hardhat run scripts/deploy.cjs --network localhost
```

#### æµ‹è¯•ç½‘ç»œéƒ¨ç½²
```bash
# éƒ¨ç½²åˆ°Sepoliaæµ‹è¯•ç½‘
npx hardhat run scripts/deploy.cjs --network sepolia
```

### ğŸ“– ä½¿ç”¨æŒ‡å—

#### åˆæ¬¡ä½¿ç”¨
1. **å®‰è£…MetaMask**ï¼šåœ¨æµè§ˆå™¨ä¸­å®‰è£…MetaMaskæ’ä»¶
2. **åˆ›å»ºé’±åŒ…**ï¼šåˆ›å»ºæˆ–å¯¼å…¥ä»¥å¤ªåŠé’±åŒ…
3. **è¿æ¥åº”ç”¨**ï¼šç‚¹å‡»"è¿æ¥é’±åŒ…"æŒ‰é’®è¿æ¥MetaMask
4. **è·å–æµ‹è¯•å¸**ï¼šåœ¨æµ‹è¯•ç½‘ç»œä¸­è·å–æµ‹è¯•ETH

#### è®°å½•ç¢³æ’æ”¾
1. è¿›å…¥"ç¢³æ’æ”¾"é¡µé¢
2. é€‰æ‹©æ´»åŠ¨ç±»å‹ï¼ˆå·¥å‚ç”Ÿäº§ã€äº¤é€šè¿è¾“ç­‰ï¼‰
3. è¾“å…¥æ’æ”¾é‡ï¼ˆkg COâ‚‚ï¼‰
4. æäº¤è®°å½•åˆ°åŒºå—é“¾
5. ç­‰å¾…äº¤æ˜“ç¡®è®¤

#### æäº¤å‡æ’é¡¹ç›®
1. è¿›å…¥"é¡¹ç›®"é¡µé¢
2. ç‚¹å‡»"æäº¤é¡¹ç›®"æŒ‰é’®
3. å¡«å†™é¡¹ç›®è¯¦ç»†ä¿¡æ¯
4. ä¸Šä¼ é¡¹ç›®æ–‡æ¡£
5. æäº¤ç­‰å¾…å®¡æ ¸

#### äº¤æ˜“ç¢³ä¿¡ç”¨
1. è¿›å…¥"äº¤æ˜“å¸‚åœº"é¡µé¢
2. æµè§ˆå¯è´­ä¹°çš„ç¢³ä¿¡ç”¨
3. é€‰æ‹©åˆé€‚çš„ä¿¡ç”¨å’Œæ•°é‡
4. ç¡®è®¤äº¤æ˜“å¹¶æ”¯ä»˜
5. æŸ¥çœ‹äº¤æ˜“ç»“æœ

### ğŸ” å®‰å…¨ç‰¹æ€§

#### æ™ºèƒ½åˆçº¦å®‰å…¨æœºåˆ¶

##### é‡å…¥æ”»å‡»é˜²æŠ¤
```solidity
import "@openzeppelin/contracts/security/ReentrancyGuard.sol";

contract CarbonCreditSystem is ReentrancyGuard {
    function buyCredit(uint256 listingId) external payable nonReentrant {
        // é˜²æ­¢é‡å…¥æ”»å‡»çš„äº¤æ˜“é€»è¾‘
    }
}
```

##### æƒé™æ§åˆ¶ç³»ç»Ÿ
```solidity
import "@openzeppelin/contracts/access/AccessControl.sol";

contract CarbonCreditSystem is AccessControl {
    bytes32 public constant VERIFIER_ROLE = keccak256("VERIFIER_ROLE");
    bytes32 public constant PROVIDER_ROLE = keccak256("PROVIDER_ROLE");
    
    modifier onlyVerifier() {
        require(hasRole(VERIFIER_ROLE, msg.sender), "Caller is not a verifier");
        _;
    }
    
    modifier onlyProvider() {
        require(hasRole(PROVIDER_ROLE, msg.sender), "Caller is not a provider");
        _;
    }
}
```

##### è¾“å…¥éªŒè¯å’Œè¾¹ç•Œæ£€æŸ¥
```solidity
function recordEmission(uint256 amount, string memory activityType) external {
    require(amount > 0, "Amount must be greater than 0");
    require(bytes(activityType).length > 0, "Activity type cannot be empty");
    require(amount <= MAX_EMISSION_AMOUNT, "Amount exceeds maximum limit");
    
    // è®°å½•æ’æ”¾é€»è¾‘
}
```

##### æ•´æ•°æº¢å‡ºé˜²æŠ¤
- ä½¿ç”¨Solidity 0.8.xå†…ç½®çš„æº¢å‡ºæ£€æŸ¥
- å…³é”®è®¡ç®—ä½¿ç”¨SafeMathåº“è¿›è¡Œé¢å¤–ä¿æŠ¤
- æ‰€æœ‰æ•°å€¼æ“ä½œéƒ½è¿›è¡Œè¾¹ç•Œæ£€æŸ¥

##### çŠ¶æ€ä¸€è‡´æ€§ä¿æŠ¤
```solidity
function buyCredit(uint256 listingId) external payable nonReentrant {
    CreditListing storage listing = creditListings[listingId];
    require(listing.active, "Listing is not active");
    require(msg.value >= listing.pricePerCredit * listing.amount, "Insufficient payment");
    
    // å…ˆæ›´æ–°çŠ¶æ€
    listing.active = false;
    
    // å†è¿›è¡Œå¤–éƒ¨è°ƒç”¨
    _transferCredits(listing.seller, msg.sender, listing.amount, listing.projectId);
}
```

#### å‰ç«¯å®‰å…¨æœºåˆ¶

##### Web3å®‰å…¨å®è·µ
```typescript
// ç­¾åéªŒè¯
const verifySignature = async (message: string, signature: string, expectedAddress: string): Promise<boolean> => {
  try {
    const recoveredAddress = ethers.verifyMessage(message, signature);
    return recoveredAddress.toLowerCase() === expectedAddress.toLowerCase();
  } catch (error) {
    return false;
  }
};

// äº¤æ˜“å‚æ•°éªŒè¯
const validateTransactionParams = (params: any): boolean => {
  if (!params.to || !ethers.isAddress(params.to)) return false;
  if (!params.value || ethers.getBigInt(params.value) < 0) return false;
  if (!params.gasLimit || ethers.getBigInt(params.gasLimit) <= 0) return false;
  return true;
};
```

##### è¾“å…¥éªŒè¯å’Œæ¸…ç†
```typescript
// ä¸¥æ ¼çš„è¾“å…¥éªŒè¯
const validateEmissionInput = (amount: string, activityType: string): ValidationResult => {
  const errors: string[] = [];
  
  // æ•°å€¼éªŒè¯
  const numAmount = parseFloat(amount);
  if (isNaN(numAmount) || numAmount <= 0) {
    errors.push('æ’æ”¾é‡å¿…é¡»æ˜¯å¤§äº0çš„æ•°å­—');
  }
  if (numAmount > 1000000) {
    errors.push('æ’æ”¾é‡ä¸èƒ½è¶…è¿‡1,000,000 kg COâ‚‚');
  }
  
  // å­—ç¬¦ä¸²éªŒè¯å’Œæ¸…ç†
  const cleanActivityType = activityType.trim();
  if (!cleanActivityType || cleanActivityType.length < 2) {
    errors.push('æ´»åŠ¨ç±»å‹ä¸èƒ½ä¸ºç©ºä¸”è‡³å°‘åŒ…å«2ä¸ªå­—ç¬¦');
  }
  if (cleanActivityType.length > 50) {
    errors.push('æ´»åŠ¨ç±»å‹ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦');
  }
  
  // æ£€æŸ¥è¿ç¦è¯
  const forbiddenWords = ['script', 'javascript', 'eval', 'function'];
  if (forbiddenWords.some(word => cleanActivityType.toLowerCase().includes(word))) {
    errors.push('æ´»åŠ¨ç±»å‹åŒ…å«ä¸å…è®¸çš„å†…å®¹');
  }
  
  return {
    isValid: errors.length === 0,
    errors,
    cleanData: { amount: numAmount, activityType: cleanActivityType }
  };
};
```

##### XSSå’ŒCSRFé˜²æŠ¤
```typescript
// HTMLå†…å®¹æ¸…ç†
import DOMPurify from 'dompurify';

const sanitizeHTML = (html: string): string => {
  return DOMPurify.sanitize(html, {
    ALLOWED_TAGS: ['b', 'i', 'em', 'strong', 'p', 'br'],
    ALLOWED_ATTR: []
  });
};

// CSRFä»¤ç‰ŒéªŒè¯
const generateCSRFToken = (): string => {
  return ethers.hexlify(ethers.randomBytes(32));
};

const validateCSRFToken = (token: string, expectedToken: string): boolean => {
  return token === expectedToken;
};
```

##### é”™è¯¯å¤„ç†å’Œä¿¡æ¯æ³„éœ²é˜²æŠ¤
```typescript
const handleError = (error: any, context: string): AppError => {
  // è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼ˆä»…åœ¨å¼€å‘ç¯å¢ƒï¼‰
  if (import.meta.env.DEV) {
    console.error(`Error in ${context}:`, error);
  }
  
  // ç”Ÿäº§ç¯å¢ƒä¸­è¿”å›é€šç”¨é”™è¯¯ä¿¡æ¯
  if (import.meta.env.PROD) {
    return new AppError('æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'OPERATION_FAILED');
  }
  
  // å¼€å‘ç¯å¢ƒè¿”å›è¯¦ç»†é”™è¯¯
  return new AppError(error.message || 'æœªçŸ¥é”™è¯¯', error.code || 'UNKNOWN_ERROR');
};
```

### âš¡ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### æ™ºèƒ½åˆçº¦Gasä¼˜åŒ–

##### å­˜å‚¨ä¼˜åŒ–
```solidity
// ä½¿ç”¨packedç»“æ„ä½“å‡å°‘å­˜å‚¨æ§½
struct PackedEmissionRecord {
    uint128 amount;          // 128ä½è¶³å¤Ÿå­˜å‚¨æ’æ”¾é‡
    uint64 timestamp;        // 64ä½æ—¶é—´æˆ³
    uint32 activityTypeId;   // ä½¿ç”¨IDä»£æ›¿å­—ç¬¦ä¸²
    bool verified;           // å¸ƒå°”å€¼
    address verifier;        // 160ä½åœ°å€
}

// æ‰¹é‡æ“ä½œå‡å°‘äº¤æ˜“æ¬¡æ•°
function batchRecordEmissions(
    uint256[] calldata amounts,
    uint32[] calldata activityTypeIds
) external {
    require(amounts.length == activityTypeIds.length, "Array length mismatch");
    
    for (uint256 i = 0; i < amounts.length; i++) {
        _recordEmission(amounts[i], activityTypeIds[i]);
    }
}
```

##### äº‹ä»¶ä¼˜åŒ–
```solidity
// ä½¿ç”¨indexedå‚æ•°ä¼˜åŒ–äº‹ä»¶æŸ¥è¯¢
event EmissionRecorded(
    address indexed user,
    uint256 indexed activityTypeId,
    uint256 amount,
    uint256 timestamp
);

// é¿å…åœ¨äº‹ä»¶ä¸­å­˜å‚¨å¤§é‡æ•°æ®
event ProjectSubmitted(
    uint256 indexed projectId,
    address indexed provider,
    bytes32 indexed nameHash  // ä½¿ç”¨å“ˆå¸Œä»£æ›¿å®Œæ•´å­—ç¬¦ä¸²
);
```

#### å‰ç«¯æ€§èƒ½ä¼˜åŒ–

##### ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
```typescript
// è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
const Market = lazy(() => import('../pages/Market'));
const Emissions = lazy(() => import('../pages/Emissions'));
const Projects = lazy(() => import('../pages/Projects'));

// ç»„ä»¶çº§åˆ«çš„æ‡’åŠ è½½
const ChartComponent = lazy(() => import('../components/Chart'));

// æ¡ä»¶åŠ è½½
const AdminPanel = lazy(() => 
  import('../components/AdminPanel').then(module => ({
    default: module.AdminPanel
  }))
);
```

##### çŠ¶æ€ç®¡ç†ä¼˜åŒ–
```typescript
// ZustandçŠ¶æ€åˆ†ç‰‡
const useEmissionStore = create<EmissionState>((set, get) => ({
  emissions: [],
  loading: false,
  error: null,
  
  // ä½¿ç”¨immerè¿›è¡Œä¸å¯å˜æ›´æ–°
  addEmission: (emission) => set(produce((state) => {
    state.emissions.push(emission);
  })),
  
  // é€‰æ‹©å™¨ä¼˜åŒ–
  getVerifiedEmissions: () => get().emissions.filter(e => e.verified),
  getTotalEmissions: () => get().emissions.reduce((sum, e) => sum + e.amount, 0)
}));

// ä½¿ç”¨é€‰æ‹©å™¨é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
const verifiedEmissions = useEmissionStore(state => state.getVerifiedEmissions());
```

##### æ•°æ®ç¼“å­˜å’Œé¢„å–
```typescript
// React Queryé›†æˆ
const useEmissions = (userAddress: string) => {
  return useQuery({
    queryKey: ['emissions', userAddress],
    queryFn: () => contractService.getUserEmissions(userAddress),
    staleTime: 5 * 60 * 1000, // 5åˆ†é’Ÿç¼“å­˜
    cacheTime: 10 * 60 * 1000, // 10åˆ†é’Ÿä¿ç•™
    refetchOnWindowFocus: false
  });
};

// é¢„å–ç›¸å…³æ•°æ®
const prefetchUserData = async (userAddress: string) => {
  const queryClient = useQueryClient();
  
  await Promise.all([
    queryClient.prefetchQuery({
      queryKey: ['emissions', userAddress],
      queryFn: () => contractService.getUserEmissions(userAddress)
    }),
    queryClient.prefetchQuery({
      queryKey: ['balance', userAddress],
      queryFn: () => contractService.getUserBalance(userAddress)
    })
  ]);
};
```

##### è™šæ‹Ÿæ»šåŠ¨å’Œåˆ†é¡µ
```typescript
// è™šæ‹Ÿæ»šåŠ¨å®ç°
const VirtualizedList = ({ items, itemHeight = 60 }: VirtualizedListProps) => {
  const [startIndex, setStartIndex] = useState(0);
  const [endIndex, setEndIndex] = useState(10);
  const containerRef = useRef<HTMLDivElement>(null);
  
  const handleScroll = useCallback(() => {
    if (!containerRef.current) return;
    
    const scrollTop = containerRef.current.scrollTop;
    const containerHeight = containerRef.current.clientHeight;
    
    const newStartIndex = Math.floor(scrollTop / itemHeight);
    const newEndIndex = Math.min(
      newStartIndex + Math.ceil(containerHeight / itemHeight) + 1,
      items.length
    );
    
    setStartIndex(newStartIndex);
    setEndIndex(newEndIndex);
  }, [itemHeight, items.length]);
  
  const visibleItems = items.slice(startIndex, endIndex);
  
  return (
    <div
      ref={containerRef}
      onScroll={handleScroll}
      style={{ height: '400px', overflow: 'auto' }}
    >
      <div style={{ height: startIndex * itemHeight }} />
      {visibleItems.map((item, index) => (
        <div key={startIndex + index} style={{ height: itemHeight }}>
          {/* æ¸²æŸ“é¡¹ç›®å†…å®¹ */}
        </div>
      ))}
      <div style={{ height: (items.length - endIndex) * itemHeight }} />
    </div>
  );
};
```

### ğŸ§ª æµ‹è¯•ç­–ç•¥

#### æ™ºèƒ½åˆçº¦æµ‹è¯•

##### å•å…ƒæµ‹è¯•
```javascript
// test/CarbonCreditSystem.test.js
const { expect } = require("chai");
const { ethers } = require("hardhat");

describe("CarbonCreditSystem", function () {
  let carbonSystem, carbonNFT;
  let owner, verifier, provider, user;

  beforeEach(async function () {
    [owner, verifier, provider, user] = await ethers.getSigners();
    
    // éƒ¨ç½²NFTåˆçº¦
    const CarbonCreditNFT = await ethers.getContractFactory("CarbonCreditNFT");
    carbonNFT = await CarbonCreditNFT.deploy();
    
    // éƒ¨ç½²ä¸»åˆçº¦
    const CarbonCreditSystem = await ethers.getContractFactory("CarbonCreditSystem");
    carbonSystem = await CarbonCreditSystem.deploy(carbonNFT.address);
    
    // è®¾ç½®æƒé™
    await carbonSystem.grantRole(await carbonSystem.VERIFIER_ROLE(), verifier.address);
    await carbonSystem.grantRole(await carbonSystem.PROVIDER_ROLE(), provider.address);
  });

  describe("æ’æ”¾è®°å½•åŠŸèƒ½", function () {
    it("åº”è¯¥èƒ½å¤Ÿè®°å½•æ’æ”¾æ•°æ®", async function () {
      const amount = ethers.parseUnits("10.5", 18);
      const activityType = "transportation";
      
      await expect(carbonSystem.connect(user).recordEmission(amount, activityType))
        .to.emit(carbonSystem, "EmissionRecorded")
        .withArgs(user.address, amount, activityType);
      
      const emissions = await carbonSystem.getUserEmissions(user.address);
      expect(emissions.length).to.equal(1);
      expect(emissions[0].amount).to.equal(amount);
      expect(emissions[0].activityType).to.equal(activityType);
    });
    
    it("éªŒè¯è€…åº”è¯¥èƒ½å¤ŸéªŒè¯æ’æ”¾è®°å½•", async function () {
      // å…ˆè®°å½•æ’æ”¾
      await carbonSystem.connect(user).recordEmission(ethers.parseUnits("10.5", 18), "transportation");
      
      // éªŒè¯è€…éªŒè¯
      await expect(carbonSystem.connect(verifier).verifyEmission(user.address, 0))
        .to.emit(carbonSystem, "EmissionVerified")
        .withArgs(user.address, 0, verifier.address);
      
      const emissions = await carbonSystem.getUserEmissions(user.address);
      expect(emissions[0].verified).to.be.true;
      expect(emissions[0].verifier).to.equal(verifier.address);
    });
  });

  describe("é¡¹ç›®ç®¡ç†åŠŸèƒ½", function () {
    it("é¡¹ç›®æä¾›å•†åº”è¯¥èƒ½å¤Ÿåˆ›å»ºé¡¹ç›®", async function () {
      const projectData = {
        name: "Solar Farm Project",
        description: "Large scale solar energy project",
        projectType: "renewable_energy",
        totalCredits: 1000
      };
      
      await expect(carbonSystem.connect(provider).createProject(
        projectData.name,
        projectData.description,
        projectData.projectType,
        projectData.totalCredits
      )).to.emit(carbonSystem, "ProjectCreated");
      
      const projects = await carbonSystem.getAllProjects();
      expect(projects.length).to.equal(1);
      expect(projects[0].name).to.equal(projectData.name);
      expect(projects[0].provider).to.equal(provider.address);
    });
  });

  describe("äº¤æ˜“å¸‚åœºåŠŸèƒ½", function () {
    beforeEach(async function () {
      // åˆ›å»ºå¹¶å®¡æ ¸é¡¹ç›®
      await carbonSystem.connect(provider).createProject("Test Project", "Description", "renewable_energy", 1000);
      await carbonSystem.connect(verifier).approveProject(0);
    });
    
    it("åº”è¯¥èƒ½å¤Ÿä¸Šæ¶å’Œè´­ä¹°ç¢³ä¿¡ç”¨", async function () {
      const amount = 100;
      const pricePerCredit = ethers.parseEther("0.01");
      
      // ä¸Šæ¶ç¢³ä¿¡ç”¨
      await carbonSystem.connect(provider).listCredit(amount, pricePerCredit, 0);
      
      // è´­ä¹°ç¢³ä¿¡ç”¨
      const totalPrice = pricePerCredit * BigInt(amount);
      await expect(carbonSystem.connect(user).buyCredit(0, { value: totalPrice }))
        .to.emit(carbonSystem, "CreditPurchased")
        .withArgs(0, user.address, amount, totalPrice);
      
      // éªŒè¯ä½™é¢
      const balance = await carbonSystem.carbonCredits(user.address);
      expect(balance).to.equal(amount);
    });
  });
});
```

##### é›†æˆæµ‹è¯•
```javascript
// test/integration/FullWorkflow.test.js
describe("å®Œæ•´å·¥ä½œæµç¨‹æµ‹è¯•", function () {
  it("åº”è¯¥æ”¯æŒå®Œæ•´çš„ç¢³ä¿¡ç”¨ç”Ÿå‘½å‘¨æœŸ", async function () {
    // 1. è®°å½•æ’æ”¾
    await carbonSystem.connect(user).recordEmission(ethers.parseUnits("100", 18), "factory");
    
    // 2. éªŒè¯æ’æ”¾
    await carbonSystem.connect(verifier).verifyEmission(user.address, 0);
    
    // 3. åˆ›å»ºå‡æ’é¡¹ç›®
    await carbonSystem.connect(provider).createProject("Wind Farm", "Wind energy project", "renewable_energy", 500);
    
    // 4. å®¡æ ¸é¡¹ç›®
    await carbonSystem.connect(verifier).approveProject(0);
    
    // 5. ä¸Šæ¶ç¢³ä¿¡ç”¨
    await carbonSystem.connect(provider).listCredit(100, ethers.parseEther("0.02"), 0);
    
    // 6. è´­ä¹°ç¢³ä¿¡ç”¨
    await carbonSystem.connect(user).buyCredit(0, { value: ethers.parseEther("2") });
    
    // 7. éªŒè¯æœ€ç»ˆçŠ¶æ€
    const userBalance = await carbonSystem.carbonCredits(user.address);
    const userEmissions = await carbonSystem.getUserEmissions(user.address);
    const projects = await carbonSystem.getAllProjects();
    
    expect(userBalance).to.equal(100);
    expect(userEmissions[0].verified).to.be.true;
    expect(projects[0].approved).to.be.true;
  });
});
```

#### å‰ç«¯æµ‹è¯•

##### ç»„ä»¶å•å…ƒæµ‹è¯•
```typescript
// src/components/__tests__/EmissionForm.test.tsx
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import { vi } from 'vitest';
import EmissionForm from '../EmissionForm';
import { Web3Provider } from '../../contexts/Web3Context';

// Mock Web3Context
const mockWeb3Context = {
  isConnected: true,
  account: '0x1234567890123456789012345678901234567890',
  contract: {
    recordEmission: vi.fn()
  }
};

const renderWithContext = (component: React.ReactElement) => {
  return render(
    <Web3Provider value={mockWeb3Context}>
      {component}
    </Web3Provider>
  );
};

describe('EmissionForm', () => {
  beforeEach(() => {
    vi.clearAllMocks();
  });

  it('åº”è¯¥æ¸²æŸ“è¡¨å•å…ƒç´ ', () => {
    renderWithContext(<EmissionForm />);
    
    expect(screen.getByLabelText(/æ’æ”¾é‡/i)).toBeInTheDocument();
    expect(screen.getByLabelText(/æ´»åŠ¨ç±»å‹/i)).toBeInTheDocument();
    expect(screen.getByRole('button', { name: /è®°å½•æ’æ”¾/i })).toBeInTheDocument();
  });

  it('åº”è¯¥éªŒè¯è¾“å…¥å¹¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯', async () => {
    renderWithContext(<EmissionForm />);
    
    const submitButton = screen.getByRole('button', { name: /è®°å½•æ’æ”¾/i });
    fireEvent.click(submitButton);
    
    await waitFor(() => {
      expect(screen.getByText(/æ’æ”¾é‡ä¸èƒ½ä¸ºç©º/i)).toBeInTheDocument();
      expect(screen.getByText(/è¯·é€‰æ‹©æ´»åŠ¨ç±»å‹/i)).toBeInTheDocument();
    });
  });

  it('åº”è¯¥æˆåŠŸæäº¤æœ‰æ•ˆæ•°æ®', async () => {
    const mockRecordEmission = vi.fn().mockResolvedValue({ hash: '0xabc123' });
    mockWeb3Context.contract.recordEmission = mockRecordEmission;
    
    renderWithContext(<EmissionForm />);
    
    // å¡«å†™è¡¨å•
    fireEvent.change(screen.getByLabelText(/æ’æ”¾é‡/i), { target: { value: '10.5' } });
    fireEvent.change(screen.getByLabelText(/æ´»åŠ¨ç±»å‹/i), { target: { value: 'transportation' } });
    
    // æäº¤è¡¨å•
    fireEvent.click(screen.getByRole('button', { name: /è®°å½•æ’æ”¾/i }));
    
    await waitFor(() => {
      expect(mockRecordEmission).toHaveBeenCalledWith(
        expect.any(String), // amount in wei
        'transportation'
      );
    });
  });
});
```

##### E2Eæµ‹è¯•
```typescript
// e2e/carbon-trading.spec.ts
import { test, expect } from '@playwright/test';

test.describe('ç¢³äº¤æ˜“DApp E2Eæµ‹è¯•', () => {
  test.beforeEach(async ({ page }) => {
    // è®¿é—®åº”ç”¨
    await page.goto('http://localhost:5173');
    
    // æ¨¡æ‹ŸMetaMaskè¿æ¥
    await page.addInitScript(() => {
      window.ethereum = {
        isMetaMask: true,
        request: async ({ method }) => {
          if (method === 'eth_requestAccounts') {
            return ['0x1234567890123456789012345678901234567890'];
          }
          if (method === 'eth_chainId') {
            return '0xaa36a7'; // Sepolia
          }
          return null;
        },
        on: () => {},
        removeListener: () => {}
      };
    });
  });

  test('ç”¨æˆ·åº”è¯¥èƒ½å¤Ÿè¿æ¥é’±åŒ…', async ({ page }) => {
    // ç‚¹å‡»è¿æ¥é’±åŒ…æŒ‰é’®
    await page.click('[data-testid="connect-wallet"]');
    
    // éªŒè¯è¿æ¥æˆåŠŸ
    await expect(page.locator('[data-testid="wallet-address"]')).toBeVisible();
    await expect(page.locator('[data-testid="wallet-address"]')).toContainText('0x1234...7890');
  });

  test('ç”¨æˆ·åº”è¯¥èƒ½å¤Ÿè®°å½•æ’æ”¾', async ({ page }) => {
    // è¿æ¥é’±åŒ…
    await page.click('[data-testid="connect-wallet"]');
    await page.waitForSelector('[data-testid="wallet-address"]');
    
    // å¯¼èˆªåˆ°æ’æ”¾é¡µé¢
    await page.click('[data-testid="nav-emissions"]');
    
    // å¡«å†™æ’æ”¾è¡¨å•
    await page.fill('[data-testid="emission-amount"]', '10.5');
    await page.selectOption('[data-testid="activity-type"]', 'transportation');
    
    // æäº¤è¡¨å•
    await page.click('[data-testid="submit-emission"]');
    
    // éªŒè¯æˆåŠŸæ¶ˆæ¯
    await expect(page.locator('[data-testid="success-toast"]')).toBeVisible();
  });

  test('ç”¨æˆ·åº”è¯¥èƒ½å¤Ÿæµè§ˆå’Œè´­ä¹°ç¢³ä¿¡ç”¨', async ({ page }) => {
    // è¿æ¥é’±åŒ…
    await page.click('[data-testid="connect-wallet"]');
    await page.waitForSelector('[data-testid="wallet-address"]');
    
    // å¯¼èˆªåˆ°å¸‚åœºé¡µé¢
    await page.click('[data-testid="nav-market"]');
    
    // ç­‰å¾…å¸‚åœºæ•°æ®åŠ è½½
    await page.waitForSelector('[data-testid="credit-listing"]');
    
    // ç‚¹å‡»è´­ä¹°æŒ‰é’®
    await page.click('[data-testid="buy-credit-0"]');
    
    // ç¡®è®¤è´­ä¹°
    await page.click('[data-testid="confirm-purchase"]');
    
    // éªŒè¯è´­ä¹°æˆåŠŸ
    await expect(page.locator('[data-testid="purchase-success"]')).toBeVisible();
  });
});
```

#### æµ‹è¯•è¦†ç›–ç‡
- **æ™ºèƒ½åˆçº¦æµ‹è¯•è¦†ç›–ç‡**ï¼š95%+
  - å‡½æ•°è¦†ç›–ç‡ï¼š100%
  - åˆ†æ”¯è¦†ç›–ç‡ï¼š95%
  - è¯­å¥è¦†ç›–ç‡ï¼š98%
- **å‰ç«¯ç»„ä»¶æµ‹è¯•è¦†ç›–ç‡**ï¼š90%+
  - ç»„ä»¶è¦†ç›–ç‡ï¼š95%
  - å‡½æ•°è¦†ç›–ç‡ï¼š90%
  - è¡Œè¦†ç›–ç‡ï¼š92%
- **é›†æˆæµ‹è¯•è¦†ç›–ç‡**ï¼š85%+
- **E2Eæµ‹è¯•è¦†ç›–ç‡**ï¼š80%+

#### è¿è¡Œæµ‹è¯•
```bash
# æ™ºèƒ½åˆçº¦æµ‹è¯•
npm run test:contracts
npm run test:contracts:coverage

# å‰ç«¯å•å…ƒæµ‹è¯•
npm run test:frontend
npm run test:frontend:coverage

# E2Eæµ‹è¯•
npm run test:e2e
npm run test:e2e:headed  # æœ‰ç•Œé¢æ¨¡å¼

# æ‰€æœ‰æµ‹è¯•
npm run test:all

# ç”Ÿæˆå®Œæ•´æµ‹è¯•æŠ¥å‘Š
npm run test:report
```

### ğŸ“¦ æ„å»ºå’Œéƒ¨ç½²

#### éƒ¨ç½²é…ç½®è¯¦è§£

##### æ™ºèƒ½åˆçº¦éƒ¨ç½²æµç¨‹

**1. æœ¬åœ°å¼€å‘ç¯å¢ƒéƒ¨ç½²**
```bash
# å¯åŠ¨æœ¬åœ°HardhatèŠ‚ç‚¹
npx hardhat node

# åœ¨æ–°ç»ˆç«¯ä¸­éƒ¨ç½²åˆçº¦
npm run deploy:local

# éªŒè¯éƒ¨ç½²ç»“æœ
npx hardhat console --network localhost
```

**2. Sepoliaæµ‹è¯•ç½‘éƒ¨ç½²**
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export SEPOLIA_PRIVATE_KEY="your_private_key"
export SEPOLIA_RPC_URL="https://sepolia.infura.io/v3/your_project_id"
export ETHERSCAN_API_KEY="your_etherscan_api_key"

# éƒ¨ç½²åˆ°Sepolia
npm run deploy:sepolia

# éªŒè¯åˆçº¦æºç 
npm run verify:sepolia

# æ›´æ–°å‰ç«¯é…ç½®
npm run update-frontend-config
```

**3. ä¸»ç½‘éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰**
```bash
# è®¾ç½®ä¸»ç½‘ç¯å¢ƒå˜é‡
export MAINNET_PRIVATE_KEY="your_mainnet_private_key"
export MAINNET_RPC_URL="https://mainnet.infura.io/v3/your_project_id"

# éƒ¨ç½²å‰æ£€æŸ¥
npm run pre-deploy-check

# éƒ¨ç½²åˆ°ä¸»ç½‘
npm run deploy:mainnet

# éªŒè¯å’Œæ›´æ–°é…ç½®
npm run verify:mainnet
npm run update-production-config
```

##### å‰ç«¯éƒ¨ç½²é…ç½®

**1. å¼€å‘ç¯å¢ƒ**
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# å¼€å‘ç¯å¢ƒç‰¹æ€§ï¼š
# - çƒ­é‡è½½
# - æºç æ˜ å°„
# - è¯¦ç»†é”™è¯¯ä¿¡æ¯
# - å¼€å‘è€…å·¥å…·é›†æˆ
```

**2. é¢„å‘å¸ƒç¯å¢ƒ**
```bash
# æ„å»ºé¢„å‘å¸ƒç‰ˆæœ¬
npm run build:staging

# é¢„è§ˆæ„å»ºç»“æœ
npm run preview

# éƒ¨ç½²åˆ°é¢„å‘å¸ƒç¯å¢ƒ
npm run deploy:staging
```

**3. ç”Ÿäº§ç¯å¢ƒ**
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# ä¼˜åŒ–å’Œå‹ç¼©
npm run optimize

# éƒ¨ç½²åˆ°GitHub Pages
npm run deploy

# æˆ–éƒ¨ç½²åˆ°è‡ªå®šä¹‰æœåŠ¡å™¨
npm run deploy:custom
```

#### CI/CD æµæ°´çº¿

##### GitHub Actions é…ç½®
```yaml
# .github/workflows/deploy.yml
name: Deploy Carbon Trading DApp

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Run tests
        run: |
          npm run test:contracts
          npm run test:frontend
          npm run test:e2e
      
      - name: Generate coverage report
        run: npm run coverage
      
      - name: Upload coverage to Codecov
        uses: codecov/codecov-action@v3

  deploy-contracts:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Deploy to Sepolia
        env:
          SEPOLIA_PRIVATE_KEY: ${{ secrets.SEPOLIA_PRIVATE_KEY }}
          SEPOLIA_RPC_URL: ${{ secrets.SEPOLIA_RPC_URL }}
          ETHERSCAN_API_KEY: ${{ secrets.ETHERSCAN_API_KEY }}
        run: |
          npm run deploy:sepolia
          npm run verify:sepolia

  deploy-frontend:
    needs: [test, deploy-contracts]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Build frontend
        run: npm run build
      
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./dist
```

#### ç¯å¢ƒé…ç½®ç®¡ç†

##### ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env.local (æœ¬åœ°å¼€å‘)
VITE_NETWORK=localhost
VITE_CONTRACT_ADDRESS_SYSTEM=0x5FbDB2315678afecb367f032d93F642f64180aa3
VITE_CONTRACT_ADDRESS_NFT=0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512
VITE_RPC_URL=http://127.0.0.1:8545
VITE_CHAIN_ID=31337

# .env.staging (é¢„å‘å¸ƒ)
VITE_NETWORK=sepolia
VITE_CONTRACT_ADDRESS_SYSTEM=0x...
VITE_CONTRACT_ADDRESS_NFT=0x...
VITE_RPC_URL=https://sepolia.infura.io/v3/...
VITE_CHAIN_ID=11155111

# .env.production (ç”Ÿäº§)
VITE_NETWORK=mainnet
VITE_CONTRACT_ADDRESS_SYSTEM=0x...
VITE_CONTRACT_ADDRESS_NFT=0x...
VITE_RPC_URL=https://mainnet.infura.io/v3/...
VITE_CHAIN_ID=1
```

##### é…ç½®ç®¡ç†è„šæœ¬
```javascript
// scripts/config-manager.js
const fs = require('fs');
const path = require('path');

class ConfigManager {
  constructor() {
    this.environments = ['local', 'staging', 'production'];
  }

  updateFrontendConfig(network, deploymentData) {
    const configPath = path.join(__dirname, '../src/config/contracts.ts');
    const config = {
      [network]: {
        chainId: deploymentData.chainId,
        contracts: {
          CarbonCreditSystem: {
            address: deploymentData.CarbonCreditSystem,
            abi: require('../artifacts/contracts/CarbonCreditSystem.sol/CarbonCreditSystem.json').abi
          },
          CarbonCreditNFT: {
            address: deploymentData.CarbonCreditNFT,
            abi: require('../artifacts/contracts/CarbonCreditNFT.sol/CarbonCreditNFT.json').abi
          }
        }
      }
    };

    let existingConfig = {};
    if (fs.existsSync(configPath)) {
      existingConfig = require(configPath);
    }

    const updatedConfig = { ...existingConfig, ...config };
    
    fs.writeFileSync(
      configPath,
      `export const contractConfig = ${JSON.stringify(updatedConfig, null, 2)};`
    );

    console.log(`âœ… Frontend config updated for ${network}`);
  }

  validateDeployment(network, addresses) {
    // éªŒè¯åˆçº¦åœ°å€æ ¼å¼
    for (const [name, address] of Object.entries(addresses)) {
      if (!/^0x[a-fA-F0-9]{40}$/.test(address)) {
        throw new Error(`Invalid address for ${name}: ${address}`);
      }
    }

    // éªŒè¯ç½‘ç»œé…ç½®
    if (!this.environments.includes(network)) {
      throw new Error(`Unsupported network: ${network}`);
    }

    console.log(`âœ… Deployment validation passed for ${network}`);
  }
}

module.exports = ConfigManager;
```

#### ç›‘æ§å’Œç»´æŠ¤

##### åˆçº¦ç›‘æ§
```javascript
// scripts/monitor-contracts.js
const { ethers } = require('ethers');
const contractConfig = require('../src/config/contracts');

class ContractMonitor {
  constructor(network) {
    this.network = network;
    this.provider = new ethers.JsonRpcProvider(process.env[`${network.toUpperCase()}_RPC_URL`]);
    this.contracts = this.initializeContracts();
  }

  initializeContracts() {
    const config = contractConfig[this.network];
    return {
      system: new ethers.Contract(
        config.contracts.CarbonCreditSystem.address,
        config.contracts.CarbonCreditSystem.abi,
        this.provider
      ),
      nft: new ethers.Contract(
        config.contracts.CarbonCreditNFT.address,
        config.contracts.CarbonCreditNFT.abi,
        this.provider
      )
    };
  }

  async checkContractHealth() {
    try {
      // æ£€æŸ¥åˆçº¦æ˜¯å¦å¯è®¿é—®
      const systemOwner = await this.contracts.system.owner();
      const nftOwner = await this.contracts.nft.owner();
      
      console.log(`âœ… Contracts are healthy on ${this.network}`);
      console.log(`System owner: ${systemOwner}`);
      console.log(`NFT owner: ${nftOwner}`);
      
      return true;
    } catch (error) {
      console.error(`âŒ Contract health check failed: ${error.message}`);
      return false;
    }
  }

  async getSystemStats() {
    try {
      const totalEmissions = await this.contracts.system.totalEmissions();
      const totalProjects = await this.contracts.system.totalProjects();
      const totalCredits = await this.contracts.system.totalCreditsIssued();
      
      return {
        totalEmissions: ethers.formatUnits(totalEmissions, 18),
        totalProjects: totalProjects.toString(),
        totalCredits: totalCredits.toString(),
        timestamp: new Date().toISOString()
      };
    } catch (error) {
      console.error(`Failed to get system stats: ${error.message}`);
      return null;
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
if (require.main === module) {
  const monitor = new ContractMonitor('sepolia');
  
  setInterval(async () => {
    const isHealthy = await monitor.checkContractHealth();
    if (isHealthy) {
      const stats = await monitor.getSystemStats();
      console.log('System Stats:', stats);
    }
  }, 60000); // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
}

module.exports = ContractMonitor;
```

#### éƒ¨ç½²è„šæœ¬å‘½ä»¤
```bash
# æ™ºèƒ½åˆçº¦éƒ¨ç½²
npm run compile                 # ç¼–è¯‘åˆçº¦
npm run deploy:local           # éƒ¨ç½²åˆ°æœ¬åœ°
npm run deploy:sepolia         # éƒ¨ç½²åˆ°Sepolia
npm run deploy:mainnet         # éƒ¨ç½²åˆ°ä¸»ç½‘
npm run verify:sepolia         # éªŒè¯Sepoliaåˆçº¦
npm run verify:mainnet         # éªŒè¯ä¸»ç½‘åˆçº¦

# å‰ç«¯æ„å»ºå’Œéƒ¨ç½²
npm run build                  # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build:staging          # æ„å»ºé¢„å‘å¸ƒç‰ˆæœ¬
npm run preview               # é¢„è§ˆæ„å»ºç»“æœ
npm run deploy                # éƒ¨ç½²åˆ°GitHub Pages
npm run deploy:staging        # éƒ¨ç½²åˆ°é¢„å‘å¸ƒç¯å¢ƒ

# é…ç½®ç®¡ç†
npm run update-config         # æ›´æ–°é…ç½®æ–‡ä»¶
npm run validate-config       # éªŒè¯é…ç½®
npm run backup-config         # å¤‡ä»½é…ç½®

# ç›‘æ§å’Œç»´æŠ¤
npm run monitor:contracts     # ç›‘æ§åˆçº¦çŠ¶æ€
npm run health-check         # å¥åº·æ£€æŸ¥
npm run generate-report      # ç”Ÿæˆéƒ¨ç½²æŠ¥å‘Š
```

### ğŸ› ï¸ å¼€å‘å·¥å…·å’Œè°ƒè¯•

#### å¼€å‘è€…å·¥å…·é›†æˆ

##### VS Code æ‰©å±•æ¨è
```json
// .vscode/extensions.json
{
  "recommendations": [
    "esbenp.prettier-vscode",
    "bradlc.vscode-tailwindcss",
    "ms-vscode.vscode-typescript-next",
    "ms-vscode.vscode-eslint",
    "hardhat-solidity.hardhat-solidity",
    "juanblanco.solidity",
    "ms-playwright.playwright",
    "vitest.explorer"
  ]
}
```

##### VS Code å·¥ä½œåŒºé…ç½®
```json
// .vscode/settings.json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "typescript.preferences.importModuleSpecifier": "relative",
  "solidity.defaultCompiler": "remote",
  "solidity.compileUsingRemoteVersion": "v0.8.19+commit.7dd6d404",
  "files.associations": {
    "*.sol": "solidity"
  }
}
```

#### è°ƒè¯•é…ç½®

##### å‰ç«¯è°ƒè¯•
```json
// .vscode/launch.json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Debug React App",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/node_modules/.bin/vite",
      "args": ["dev"],
      "console": "integratedTerminal",
      "env": {
        "NODE_ENV": "development"
      }
    },
    {
      "name": "Debug Tests",
      "type": "node",
      "request": "launch",
      "program": "${workspaceFolder}/node_modules/.bin/vitest",
      "args": ["run", "--reporter=verbose"],
      "console": "integratedTerminal"
    }
  ]
}
```

##### æ™ºèƒ½åˆçº¦è°ƒè¯•
```javascript
// scripts/debug-contracts.js
const { ethers } = require('hardhat');

async function debugContract() {
  const [deployer] = await ethers.getSigners();
  
  console.log('Debugging with account:', deployer.address);
  console.log('Account balance:', ethers.formatEther(await deployer.provider.getBalance(deployer.address)));
  
  // è·å–åˆçº¦å®ä¾‹
  const CarbonCreditSystem = await ethers.getContractFactory('CarbonCreditSystem');
  const carbonSystem = CarbonCreditSystem.attach('CONTRACT_ADDRESS_HERE');
  
  // è°ƒè¯•åˆçº¦çŠ¶æ€
  try {
    const owner = await carbonSystem.owner();
    console.log('Contract owner:', owner);
    
    const totalEmissions = await carbonSystem.totalEmissions();
    console.log('Total emissions:', ethers.formatUnits(totalEmissions, 18));
    
    // ç›‘å¬äº‹ä»¶
    carbonSystem.on('EmissionRecorded', (user, amount, activityType, event) => {
      console.log('Emission recorded:', {
        user,
        amount: ethers.formatUnits(amount, 18),
        activityType,
        blockNumber: event.blockNumber
      });
    });
    
  } catch (error) {
    console.error('Debug error:', error);
  }
}

debugContract().catch(console.error);
```

#### æ€§èƒ½åˆ†æå·¥å…·

##### Gas åˆ†æ
```javascript
// scripts/gas-analysis.js
const { ethers } = require('hardhat');

class GasAnalyzer {
  constructor() {
    this.gasReports = [];
  }

  async analyzeFunction(contract, functionName, args = []) {
    const gasEstimate = await contract[functionName].estimateGas(...args);
    const tx = await contract[functionName](...args);
    const receipt = await tx.wait();
    
    const report = {
      function: functionName,
      estimated: gasEstimate.toString(),
      actual: receipt.gasUsed.toString(),
      efficiency: (Number(receipt.gasUsed) / Number(gasEstimate) * 100).toFixed(2) + '%'
    };
    
    this.gasReports.push(report);
    console.log(`Gas Report for ${functionName}:`, report);
    
    return report;
  }

  generateReport() {
    console.table(this.gasReports);
    
    const totalGas = this.gasReports.reduce((sum, report) => sum + Number(report.actual), 0);
    console.log(`Total Gas Used: ${totalGas}`);
    
    return this.gasReports;
  }
}

module.exports = GasAnalyzer;
```

##### å‰ç«¯æ€§èƒ½ç›‘æ§
```typescript
// src/utils/performance.ts
export class PerformanceMonitor {
  private metrics: Map<string, number> = new Map();

  startTiming(label: string): void {
    this.metrics.set(label, performance.now());
  }

  endTiming(label: string): number {
    const startTime = this.metrics.get(label);
    if (!startTime) {
      console.warn(`No start time found for ${label}`);
      return 0;
    }

    const duration = performance.now() - startTime;
    console.log(`${label}: ${duration.toFixed(2)}ms`);
    
    this.metrics.delete(label);
    return duration;
  }

  measureAsync<T>(label: string, fn: () => Promise<T>): Promise<T> {
    return new Promise(async (resolve, reject) => {
      this.startTiming(label);
      try {
        const result = await fn();
        this.endTiming(label);
        resolve(result);
      } catch (error) {
        this.endTiming(label);
        reject(error);
      }
    });
  }

  getWebVitals(): void {
    // ç›‘æ§æ ¸å¿ƒWebæŒ‡æ ‡
    if ('web-vitals' in window) {
      import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {
        getCLS(console.log);
        getFID(console.log);
        getFCP(console.log);
        getLCP(console.log);
        getTTFB(console.log);
      });
    }
  }
}

export const performanceMonitor = new PerformanceMonitor();
```

### ğŸ”§ æ•…éšœæ’é™¤

#### å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

##### 1. é’±åŒ…è¿æ¥é—®é¢˜
```typescript
// é—®é¢˜ï¼šMetaMaskè¿æ¥å¤±è´¥
// è§£å†³æ–¹æ¡ˆï¼š
if (!window.ethereum) {
  throw new Error('è¯·å®‰è£…MetaMaské’±åŒ…');
}

// æ£€æŸ¥ç½‘ç»œ
const chainId = await window.ethereum.request({ method: 'eth_chainId' });
if (chainId !== '0xaa36a7') { // Sepolia
  await window.ethereum.request({
    method: 'wallet_switchEthereumChain',
    params: [{ chainId: '0xaa36a7' }]
  });
}
```

##### 2. åˆçº¦äº¤äº’é”™è¯¯
```javascript
// é—®é¢˜ï¼šäº¤æ˜“å¤±è´¥æˆ–Gasä¼°ç®—é”™è¯¯
// è§£å†³æ–¹æ¡ˆï¼š
try {
  // å…ˆä¼°ç®—Gas
  const gasEstimate = await contract.recordEmission.estimateGas(amount, activityType);
  
  // æ·»åŠ 20%çš„Gasç¼“å†²
  const gasLimit = Math.floor(Number(gasEstimate) * 1.2);
  
  const tx = await contract.recordEmission(amount, activityType, {
    gasLimit: gasLimit
  });
  
  await tx.wait();
} catch (error) {
  if (error.code === 'UNPREDICTABLE_GAS_LIMIT') {
    console.error('Gasä¼°ç®—å¤±è´¥ï¼Œå¯èƒ½æ˜¯åˆçº¦è°ƒç”¨ä¼šå¤±è´¥');
  } else if (error.code === 'INSUFFICIENT_FUNDS') {
    console.error('è´¦æˆ·ä½™é¢ä¸è¶³');
  } else {
    console.error('äº¤æ˜“å¤±è´¥:', error.message);
  }
}
```

##### 3. æ„å»ºå’Œéƒ¨ç½²é—®é¢˜
```bash
# é—®é¢˜ï¼šä¾èµ–å®‰è£…å¤±è´¥
# è§£å†³æ–¹æ¡ˆï¼š
rm -rf node_modules package-lock.json
npm cache clean --force
npm install

# é—®é¢˜ï¼šTypeScriptç¼–è¯‘é”™è¯¯
# è§£å†³æ–¹æ¡ˆï¼š
npm run type-check
npx tsc --noEmit

# é—®é¢˜ï¼šHardhatç¼–è¯‘å¤±è´¥
# è§£å†³æ–¹æ¡ˆï¼š
npx hardhat clean
npx hardhat compile
```

##### 4. æµ‹è¯•å¤±è´¥é—®é¢˜
```bash
# é—®é¢˜ï¼šæµ‹è¯•ç¯å¢ƒé…ç½®
# è§£å†³æ–¹æ¡ˆï¼š
export NODE_ENV=test
npm run test:setup
npm run test

# é—®é¢˜ï¼šE2Eæµ‹è¯•å¤±è´¥
# è§£å†³æ–¹æ¡ˆï¼š
npx playwright install
npm run test:e2e:setup
npm run test:e2e
```

#### æ—¥å¿—å’Œç›‘æ§

##### åº”ç”¨æ—¥å¿—é…ç½®
```typescript
// src/utils/logger.ts
export enum LogLevel {
  ERROR = 0,
  WARN = 1,
  INFO = 2,
  DEBUG = 3
}

class Logger {
  private level: LogLevel;

  constructor(level: LogLevel = LogLevel.INFO) {
    this.level = level;
  }

  error(message: string, data?: any): void {
    if (this.level >= LogLevel.ERROR) {
      console.error(`[ERROR] ${new Date().toISOString()} - ${message}`, data);
    }
  }

  warn(message: string, data?: any): void {
    if (this.level >= LogLevel.WARN) {
      console.warn(`[WARN] ${new Date().toISOString()} - ${message}`, data);
    }
  }

  info(message: string, data?: any): void {
    if (this.level >= LogLevel.INFO) {
      console.info(`[INFO] ${new Date().toISOString()} - ${message}`, data);
    }
  }

  debug(message: string, data?: any): void {
    if (this.level >= LogLevel.DEBUG) {
      console.debug(`[DEBUG] ${new Date().toISOString()} - ${message}`, data);
    }
  }
}

export const logger = new Logger(
  process.env.NODE_ENV === 'development' ? LogLevel.DEBUG : LogLevel.INFO
);
```

### ğŸ“Š é¡¹ç›®æ€»ç»“

#### æŠ€æœ¯æˆå°±

**ğŸ—ï¸ æ¶æ„è®¾è®¡**
- âœ… é‡‡ç”¨ç°ä»£åŒ–çš„åŒåˆçº¦æ¶æ„ï¼Œå®ç°äº†ä¸šåŠ¡é€»è¾‘ä¸NFTèµ„äº§çš„æœ‰æ•ˆåˆ†ç¦»
- âœ… åŸºäºReact 18 + TypeScriptçš„ç±»å‹å®‰å…¨å‰ç«¯æ¶æ„
- âœ… ä½¿ç”¨Zustandè¿›è¡Œè½»é‡çº§çŠ¶æ€ç®¡ç†ï¼Œé¿å…äº†Reduxçš„å¤æ‚æ€§
- âœ… å®ç°äº†å®Œæ•´çš„Web3é›†æˆï¼Œæ”¯æŒå¤šé’±åŒ…è¿æ¥

**ğŸ”’ å®‰å…¨ç‰¹æ€§**
- âœ… æ™ºèƒ½åˆçº¦é€šè¿‡OpenZeppelinå®‰å…¨åº“å®ç°è®¿é—®æ§åˆ¶å’Œé‡å…¥æ”»å‡»é˜²æŠ¤
- âœ… å‰ç«¯å®ç°äº†è¾“å…¥éªŒè¯ã€XSSé˜²æŠ¤å’Œé”™è¯¯è¾¹ç•Œå¤„ç†
- âœ… é‡‡ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿé…ç½®ï¼Œé¿å…ç¡¬ç¼–ç 
- âœ… å®ç°äº†å®Œæ•´çš„æƒé™ç®¡ç†ç³»ç»Ÿï¼ˆéªŒè¯è€…ã€æä¾›å•†ã€ç”¨æˆ·è§’è‰²ï¼‰

**âš¡ æ€§èƒ½ä¼˜åŒ–**
- âœ… æ™ºèƒ½åˆçº¦Gasä¼˜åŒ–ï¼šå­˜å‚¨ä¼˜åŒ–ã€æ‰¹é‡æ“ä½œã€äº‹ä»¶ä¼˜åŒ–
- âœ… å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼šä»£ç åˆ†å‰²ã€æ‡’åŠ è½½ã€è™šæ‹Ÿæ»šåŠ¨ã€æ•°æ®ç¼“å­˜
- âœ… ä½¿ç”¨Viteæ„å»ºå·¥å…·ï¼Œå®ç°å¿«é€Ÿçš„å¼€å‘å’Œæ„å»ºä½“éªŒ
- âœ… å®ç°äº†å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå¤šè®¾å¤‡è®¿é—®

**ğŸ§ª è´¨é‡ä¿è¯**
- âœ… æ™ºèƒ½åˆçº¦æµ‹è¯•è¦†ç›–ç‡95%+ï¼ŒåŒ…å«å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- âœ… å‰ç«¯ç»„ä»¶æµ‹è¯•è¦†ç›–ç‡90%+ï¼Œä½¿ç”¨Vitestå’ŒTesting Library
- âœ… E2Eæµ‹è¯•è¦†ç›–ç‡80%+ï¼Œä½¿ç”¨Playwrightè¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•
- âœ… å®Œæ•´çš„CI/CDæµæ°´çº¿ï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•å’Œéƒ¨ç½²

#### å•†ä¸šä»·å€¼

**ğŸŒ ç¯ä¿å½±å“**
- ğŸŒ± ä¸ºä¸ªäººå’Œä¼ä¸šæä¾›é€æ˜çš„ç¢³æ’æ”¾è®°å½•å’Œç®¡ç†å·¥å…·
- ğŸŒ± é€šè¿‡åŒºå—é“¾æŠ€æœ¯ç¡®ä¿ç¢³ä¿¡ç”¨äº¤æ˜“çš„çœŸå®æ€§å’Œå¯è¿½æº¯æ€§
- ğŸŒ± æ¿€åŠ±ç”¨æˆ·å‚ä¸ç¢³å‡æ’æ´»åŠ¨ï¼Œæ¨åŠ¨å¯æŒç»­å‘å±•
- ğŸŒ± æ”¯æŒå¤šç§å‡æ’é¡¹ç›®ç±»å‹ï¼Œä¿ƒè¿›ç»¿è‰²ç»æµå‘å±•

**ğŸ’¼ å¸‚åœºæ½œåŠ›**
- ğŸ“ˆ ç¢³äº¤æ˜“å¸‚åœºè§„æ¨¡é¢„è®¡å°†è¾¾åˆ°ä¸‡äº¿ç¾å…ƒçº§åˆ«
- ğŸ“ˆ åŒºå—é“¾æŠ€æœ¯ä¸ºç¢³å¸‚åœºæä¾›äº†é€æ˜åº¦å’Œä¿¡ä»»æœºåˆ¶
- ğŸ“ˆ ä¸ªäººç¢³è¶³è¿¹ç®¡ç†éœ€æ±‚æ—¥ç›Šå¢é•¿
- ğŸ“ˆ ä¼ä¸šESGåˆè§„è¦æ±‚æ¨åŠ¨ç¢³ç®¡ç†å·¥å…·éœ€æ±‚

**ğŸ”® æœªæ¥å‘å±•**
- ğŸš€ é›†æˆæ›´å¤šåŒºå—é“¾ç½‘ç»œï¼ˆPolygonã€BSCã€Arbitrumç­‰ï¼‰
- ğŸš€ å¼€å‘ç§»åŠ¨ç«¯åº”ç”¨ï¼Œæ‰©å¤§ç”¨æˆ·è¦†ç›–é¢
- ğŸš€ é›†æˆIoTè®¾å¤‡ï¼Œå®ç°è‡ªåŠ¨åŒ–æ’æ”¾æ•°æ®æ”¶é›†
- ğŸš€ å¼•å…¥AIç®—æ³•ï¼Œæä¾›ä¸ªæ€§åŒ–å‡æ’å»ºè®®
- ğŸš€ å»ºç«‹ç¢³ä¿¡ç”¨è¯„çº§å’Œè®¤è¯ä½“ç³»
- ğŸš€ å¼€å‘ä¼ä¸šçº§SaaSè§£å†³æ–¹æ¡ˆ

#### æŠ€æœ¯å€ºåŠ¡å’Œæ”¹è¿›å»ºè®®

**ğŸ”§ çŸ­æœŸæ”¹è¿›**
- [ ] å¢åŠ æ›´å¤šçš„å•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œæé«˜ä»£ç è¦†ç›–ç‡
- [ ] ä¼˜åŒ–æ™ºèƒ½åˆçº¦çš„Gasä½¿ç”¨æ•ˆç‡
- [ ] æ”¹è¿›é”™è¯¯å¤„ç†å’Œç”¨æˆ·åé¦ˆæœºåˆ¶
- [ ] æ·»åŠ æ›´å¤šçš„å›½é™…åŒ–è¯­è¨€æ”¯æŒ

**ğŸ”§ ä¸­æœŸæ”¹è¿›**
- [ ] å®ç°æ™ºèƒ½åˆçº¦çš„å¯å‡çº§æ€§ï¼ˆä»£ç†æ¨¡å¼ï¼‰
- [ ] é›†æˆæ›´å¤šçš„DeFiåè®®ï¼Œæ‰©å±•é‡‘èåŠŸèƒ½
- [ ] å¼€å‘APIæ¥å£ï¼Œæ”¯æŒç¬¬ä¸‰æ–¹é›†æˆ
- [ ] å®ç°æ•°æ®åˆ†æå’ŒæŠ¥å‘ŠåŠŸèƒ½

**ğŸ”§ é•¿æœŸæ”¹è¿›**
- [ ] è¿ç§»åˆ°Layer 2è§£å†³æ–¹æ¡ˆï¼Œé™ä½äº¤æ˜“æˆæœ¬
- [ ] å®ç°è·¨é“¾äº’æ“ä½œæ€§
- [ ] å¼€å‘å»ä¸­å¿ƒåŒ–æ²»ç†æœºåˆ¶
- [ ] å»ºç«‹ç¢³ä¿¡ç”¨è¡ç”Ÿå“äº¤æ˜“å¸‚åœº

---

**è¿™ä¸ªç¢³äº¤æ˜“DAppé¡¹ç›®å±•ç¤ºäº†åŒºå—é“¾æŠ€æœ¯åœ¨ç¯ä¿é¢†åŸŸçš„å·¨å¤§æ½œåŠ›ï¼Œé€šè¿‡æŠ€æœ¯åˆ›æ–°æ¨åŠ¨å¯æŒç»­å‘å±•ï¼Œä¸ºæ„å»ºæ›´åŠ ç»¿è‰²çš„æœªæ¥è´¡çŒ®åŠ›é‡ã€‚** ğŸŒğŸ’š

### ğŸ¤ è´¡çŒ®æŒ‡å—

#### å¼€å‘æµç¨‹
1. Forké¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

#### ä»£ç è§„èŒƒ
- ä½¿ç”¨ESLintå’ŒPrettierè¿›è¡Œä»£ç æ ¼å¼åŒ–
- éµå¾ªTypeScriptæœ€ä½³å®è·µ
- ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- æ·»åŠ é€‚å½“çš„ä»£ç æ³¨é‡Š

### ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

### ğŸ“ è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/your-username/carbon-credit-dapp
- **é—®é¢˜åé¦ˆ**: https://github.com/your-username/carbon-credit-dapp/issues
- **é‚®ç®±**: your-email@example.com

---

## <a id="english"></a>English Version

### ğŸŒ± Project Overview

Carbon Credit Trading DApp is a decentralized carbon credit trading platform built on blockchain technology, designed to enhance transparency, credibility, and efficiency in carbon trading through smart contracts and Web3 technology. This project implements comprehensive features including carbon emission recording, carbon credit project management, carbon credit trading, and verification.

### âœ¨ Core Features

#### ğŸ”— Wallet Connection & Identity Management
- **MetaMask Integration**: Support for MetaMask wallet connection
- **Multi-Network Support**: Compatible with Ethereum mainnet and testnets
- **Identity Authentication**: Blockchain address-based authentication
- **Role Management**: Support for multiple roles including verifiers and providers

#### ğŸ“Š Carbon Emission Recording System
- **Emission Data Recording**: Support for multiple activity types of carbon emission recording
- **Data Verification**: Verifiers can review and confirm emission records
- **Statistical Analysis**: Emission statistics and trend analysis
- **Historical Queries**: Complete emission record history queries

#### ğŸ­ Carbon Credit Project Management
- **Project Submission**: Emission reduction project providers can submit project applications
- **Project Review**: Verifiers review and validate projects
- **Credit Generation**: Approved projects automatically generate carbon credits
- **Project Tracking**: Real-time tracking of project status and progress

#### ğŸ’° Carbon Credit Trading Market
- **Credit Listing**: Users can list carbon credits for sale
- **Market Browsing**: Browse all available carbon credits for purchase
- **Instant Trading**: Support for instant purchase and trading
- **Price Discovery**: Market-driven price discovery mechanism

#### ğŸ‘¤ Personal Center
- **Asset Management**: View personal carbon credit balance
- **Transaction History**: Complete transaction record queries
- **Emission Statistics**: Personal carbon emission data statistics
- **Project Participation**: View status of participated projects

### ğŸ—ï¸ Technical Architecture

#### Frontend Technology Stack
- **React 18**: Modern user interface framework
- **TypeScript**: Type-safe JavaScript superset
- **Vite**: Fast build tool and development server
- **Chakra UI**: Modular and accessible component library
- **React Router**: Client-side routing management
- **Zustand**: Lightweight state management

#### Blockchain Technology Stack
- **Solidity**: Smart contract development language
- **Hardhat**: Ethereum development environment
- **ethers.js**: Ethereum JavaScript library
- **OpenZeppelin**: Secure smart contract library
- **ERC-721**: NFT standard implementation

#### Smart Contract Architecture
- **CarbonCreditSystem.sol**: Core business logic contract
- **CarbonCreditNFT.sol**: Carbon credit NFT contract
- **AccessControl**: Role-based access control
- **ReentrancyGuard**: Reentrancy attack protection

### ğŸ“‹ System Requirements

#### Development Environment
- **Node.js**: v16.0.0 or higher
- **npm**: v7.0.0 or higher
- **Git**: Version control system
- **MetaMask**: Browser wallet plugin

#### Browser Support
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

### ğŸš€ Quick Start

#### 1. Clone the Project
```bash
git clone https://github.com/your-username/carbon-credit-dapp.git
cd carbon-credit-dapp/carbon-app
```

#### 2. Install Dependencies
```bash
npm install
```

#### 3. Environment Configuration
```bash
# Copy environment variable template
cp .env.example .env

# Edit environment variables
# VITE_INFURA_PROJECT_ID=your_infura_project_id
# VITE_CONTRACT_ADDRESS=deployed_contract_address
```

#### 4. Start Development Server
```bash
npm run dev
```

#### 5. Access Application
Open your browser and visit `http://localhost:5173`

### ğŸ”§ Smart Contract Deployment

#### Local Development Network
```bash
# Start local Hardhat network
npx hardhat node

# Deploy contracts
npx hardhat run scripts/deploy.cjs --network localhost
```

#### Testnet Deployment
```bash
# Deploy to Sepolia testnet
npx hardhat run scripts/deploy.cjs --network sepolia
```

### ğŸ“– User Guide

#### First Time Use
1. **Install MetaMask**: Install MetaMask plugin in your browser
2. **Create Wallet**: Create or import an Ethereum wallet
3. **Connect Application**: Click "Connect Wallet" button to connect MetaMask
4. **Get Test Tokens**: Obtain test ETH on testnet

#### Recording Carbon Emissions
1. Navigate to "Carbon Emissions" page
2. Select activity type (factory production, transportation, etc.)
3. Enter emission amount (kg COâ‚‚)
4. Submit record to blockchain
5. Wait for transaction confirmation

#### Submitting Emission Reduction Projects
1. Navigate to "Projects" page
2. Click "Submit Project" button
3. Fill in detailed project information
4. Upload project documentation
5. Submit and wait for review

#### Trading Carbon Credits
1. Navigate to "Trading Market" page
2. Browse available carbon credits for purchase
3. Select appropriate credits and quantity
4. Confirm transaction and pay
5. View transaction results

### ğŸ” Security Features

#### Smart Contract Security
- **Reentrancy Protection**: Using ReentrancyGuard
- **Access Control**: Role-based access control
- **Input Validation**: Strict parameter validation
- **Overflow Protection**: Using SafeMath library

#### Frontend Security
- **Input Validation**: Client-side and server-side dual validation
- **XSS Protection**: React built-in XSS protection
- **CSRF Protection**: Blockchain signature-based authentication

### ğŸ§ª Testing

#### Running Tests
```bash
# Run smart contract tests
npm run test

# Run frontend tests
npm run test:frontend

# Generate test coverage report
npm run coverage
```

#### Test Coverage
- Smart contract test coverage: 95%+
- Frontend component test coverage: 90%+
- Integration test coverage: 85%+

### ğŸ“¦ Build and Deployment

#### Build Production Version
```bash
npm run build
```

#### Deploy to Vercel
```bash
# Install Vercel CLI
npm i -g vercel

# Deploy
vercel --prod
```

#### Deploy to GitHub Pages
```bash
npm run deploy
```

### ğŸ¤ Contributing

#### Development Workflow
1. Fork the project repository
2. Create a feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Create a Pull Request

#### Code Standards
- Use ESLint and Prettier for code formatting
- Follow TypeScript best practices
- Write unit tests and integration tests
- Add appropriate code comments

### ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details

### ğŸ“ Contact Us

- **Project Homepage**: https://github.com/your-username/carbon-credit-dapp
- **Issue Reporting**: https://github.com/your-username/carbon-credit-dapp/issues
- **Email**: your-email@example.com

---

## ğŸ™ Acknowledgments

- OpenZeppelin for secure smart contract libraries
- Ethereum Foundation for blockchain infrastructure
- React team for the amazing frontend framework
- All contributors who helped make this project possible

## ğŸ”® Roadmap

- [ ] Integration with real carbon offset projects
- [ ] Mobile application development
- [ ] Multi-chain support (Polygon, BSC, etc.)
- [ ] Advanced analytics and reporting
- [ ] API for third-party integrations
- [ ] Governance token implementation

---

**Built with â¤ï¸ for a sustainable future**